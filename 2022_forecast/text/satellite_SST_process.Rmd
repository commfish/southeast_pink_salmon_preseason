---
title: "Environmental variables for SEAK Pink Salmon Preseason Forecast"
author: "Sara Miller"
date: "April 12, 2021"
output:
  bookdown::pdf_document2:
    fig_caption: yes
    toc: yes
header-includes:
 \usepackage{float}
---
```{r setup, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}
library(here)
library(fs)
library(tidyverse)
library(knitr)
library(ggplot2)
library(gridExtra)
library(tidymodels)
library(lubridate)
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message = FALSE, error=FALSE)
year.forecast <- "2022_forecast" 
data.directory <- file.path(year.forecast, 'data', '/')
results.directory <- file.path(year.forecast, 'results', '/')
```

```{r data}
fs::dir_ls(here::here(results.directory), regexp = "\\.csv$") %>% 
  set_names(nm = (basename(.) %>% 
                    tools::file_path_sans_ext())) %>%
  map(read_csv) -> tbls_sst_regions
fs::dir_ls(here::here(results.directory), regexp = "\\.csv$") %>% 
  set_names(nm = (basename(.) %>% 
                    tools::file_path_sans_ext())) %>%
  map(read_csv) -> tbls_sst_SECM
```

# Objective
The overall objective is to optimize temperature variables by testing a variety of reasonable options using satellite data or Southeast Alaska Coastal Monitoring project (SECM) data within the forecast model framework. This would allow us to better evaluate our options and decide whether or not a variable change in the 2022 forecast model for SEAK pink salmon is warranted. This write-up is a summary of available sea surface temperature (SST) variables based on satellite data (average of May or the average over the months of May, June, and July from 1997 through 2020) in four regions of northern Southeast Alaska (NSEAK); Icy Strait, Chatham Strait, NSEAK as a whole, and a region that is in close proximity to the Icy Strait transect from the SECM survey (SST_Jordan). This write-up also includes a summary of SECM survey data from various months (the average of May or the average over the months of May, June, and July), and depths (i.e., 3m, 10m, 15m, 20m) of the Icy Strait and Upper Chatham transects (stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD) from 1997 through 2020. 

# Methods
## Satellite-derived SST data
Satellite-derived sea surface temperature (SST) data were pulled from the 'SST and SST Anomaly, NOAA Global Coral Bleaching Monitoring, 5km, V.3.1, Monthly, 1985-Present' time series (https://coastwatch.pfeg.noaa.gov/erddap/griddap/NOAA_DHW_monthly.html; full citation in references). This satellite-derived SST data set was then matched to pre-determined coordinates from four regions (Icy_Strait, Chatham_Strait, NEAK, and SST_Jordan) that corresponded with eight variables of interest. 

### Variables
**Icy_Strait_SST_May**: This variable is similar to the Icy Strait Temperature Index (i.e., ISTI3_May in Figure 6 and Figure 7) and is meant to replicate May sampling that occurs from vessels in Icy Strait during the SECM surveys (Icy Strait and Upper Chatham transects; stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD), a migration pinch point for salmon in Southeast Alaska (Piston et al., 2021; Figure 1 and Figure 5a; Table 1). The Icy Strait Temperature Index (i.e., ISTI3_May) is defined as the average May temperature at 3m at the Icy Strait and Upper Chatham Stations of the SECM survey. 

**Icy_Strait_SST_MJJ**: This variable is similar to the Icy Strait Temperature Index (i.e., ISTI3_MJJ in Figure 6 and Figure 7) and is meant to replicate May through July sampling that occurs from vessels in Icy Strait during the SECM surveys (Icy Strait and Upper Chatham transects; stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD), a migration pinch point for salmon in Southeast Alaska (Piston et al., 2021; Figure 1 and Figure 5b; Table 1). The Icy Strait Temperature Index (i.e., ISTI3_MJJ) is defined as the average May, June, and July temperature at 3m at the Icy Strait and Upper Chatham Stations of the SECM survey. 

**Chatham_Strait_SST_May**: The Chatham Strait region encompasses waters of Chatham Strait from the northern tip of Admiralty Island (approximately 58.425 degrees latitude north) to the approximate latitude of 56.025 degrees north (roughly Cape Decision off Kuiu Island) (Figure 2 and Figure 5a; Table 2). This variable is the average SST in May over the Chatham Strait region.

**Chatham_Strait_SST_MJJ**: The Chatham Strait region encompasses waters of Chatham Strait from the northern tip of Admiralty Island (approximately 58.425 degrees latitude north) to the approximate latitude of 56.025 degrees north (roughly Cape Decision off Kuiu Island) (Figure 2 and Figure 5b; Table 2). This variable is the average SST in May through July over the Chatham Strait region. 

**NSEAK_SST_May**: The NSEAK region encompasses northern Southeast Alaska from 59.475 to 56.075 degrees north latitude (approximately Districts 9 through 15, and District 13 inside area only; northern Southeast Inside subregion for Southeast Alaska (NSEI); Figure 3 and Figure 5a; Table 3). This variable is the average SST in May over the NSEAK region. 

**NSEAK_SST_MJJ**: The NSEAK region encompasses northern Southeast Alaska from 59.475 to 56.075 degrees north latitude (approximately Districts 9 through 15, and District 13 inside area only; northern Southeast Inside subregion for Southeast Alaska (NSEI); Figure 3 and Figure 5b; Table 3). This variable is the average SST in May through July over the NSEAK region. 

**SST_Jordan_May**: This region is meant to replicate sampling of the Icy Strait transect (stations ISA, ISB, ISC, ISD) during the SECM survey (Figure 4 and Figure 5a; Table 4). This variable is the average SST in May over the SST Jordan region.

**SST_Jordan_MJJ**: This region is meant to replicate sampling of the Icy Strait transect (stations ISA, ISB, ISC, ISD) during the SECM survey (Figure 4 and Figure 5b; Table 4). This variable is the average SST in May through July over the SST Jordan region.

## SECM survey SST data
SECM survey sea surface temperature data were summarized by year (1997 to 2020), month (the month of May or over the months of May, June, and July), and depth (3m, 10m, 15m, and 20m). Only the Icy Strait and Upper Chatham transects (stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD) are included in this data set.

### Variables

**ISTI3_May**: Average temperature at 3m during May at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6a and Figure 7; Table 5).

**ISTI3_MJJ**: Average temperature at 3m during May through July at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6b and Figure 7; Table 6).

**ISTI10_May**: Average temperature in the upper 10m during May at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6a; Table 5).

**ISTI10_MJJ**: Average temperature in the upper 10m during May through July at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6b; Table 6).

**ISTI15_May**: Average temperature in the upper 15m during May at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6a; Table 5).

**ISTI15_MJJ**: Average temperature in the upper 15m during May through July at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6b; Table 6).

**ISTI20_May**: Average temperature in the upper 20m during May at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6a; Table 5).

**ISTI20_MJJ**: Average temperature in the upper 20m during May through July at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects; Figure 6b; Table 6).

# Results  
## Satellite-derived SST data
Satellite sea surface temperature data were summarized by region and year for the month of May or over the months of May, June, and July from 1997 to 2020 (Tables 1 through 4).

\pagebreak

```{r summary1}
tbls_sst_regions$sst_oisst_97_20_Icy_Strait_monthly_summary %>%
   knitr::kable(format = 'pandoc', caption = 'Satellite sea temperature data from the Icy_Strait region from 1997 to 2020. The variable Icy_Strait_SST_MJJ is the sea surface temperature averaged over the entire Icy Strait region for the months May, June, and July. The variable Icy_Strait_SST_May is the sea surface temperature averaged over the entire Icy_Strait region for the month of May. There were 42 satellite stations (latitude/longitude combinations) in the Icy_Strait region.', row.names = F, align = "c")
```

\pagebreak

```{r summary2}
tbls_sst_regions$sst_oisst_97_20_Chatham_monthly_summary %>%
   knitr::kable(format = 'pandoc', caption = 'Satellite sea temperature data from the Chatham_Strait region from 1997 to 2020. The variable Chatham_Strait_SST_MJJ is the sea surface temperature averaged over the entire Chatham_Strait region for the months May, June, and July. The variable Chatham_Strait_SST_May is the sea surface temperature averaged over the entire Chatham_Strait region for the month of May. There were 266 satellite stations (latitude/longitude combinations) in the Chatham_Strait region.', row.names = F, align = "c")
```

\pagebreak

```{r summary3}
tbls_sst_regions$sst_oisst_97_20_NSEAK_monthly_summary %>%
   knitr::kable(format = 'pandoc', caption = 'Satellite sea temperature from the northern Southeast Alaska (NSEAK) region from 1997 to 2020. The variable NSEAK_SST_MJJ is the sea surface temperature averaged over the entire NSEAK region for the months May, June, and July. The variable NSEAK_SST_May is the sea surface temperature averaged over the entire NSEAK region for the month of May. There were 1,344 satellite stations (latitude/longitude combinations) in the NSEAK region.', row.names = F, align = "c")
```

\pagebreak

```{r summary4}
tbls_sst_regions$sst_oisst_97_20_SST_Jordan_monthly_summary %>%
   knitr::kable(format = 'pandoc', caption = 'Satellite sea temperature from the Icy Strait transect of the SECM project from 1997 to 2020. The variable SST_Jordan_MJJ is the sea surface temperature averaged over the entire Icy Strait transect for the months May, June, and July. The variable SST_Jordan_May is the sea surface temperature averaged over the entire Icy Strait transect for the month of May. There were 4 satellite stations (latitude/longitude combinations) in the SST_Jordan region.', row.names = F, align = "c")
```

## SECM survey SST data
SECM survey sea surface temperature data were summarized by year (1997 to 2020), month (the month of May or over the months of May, June, and July), and depth (3m, 10m, 15m, and 20m; Tables 5 and 6).
\pagebreak
```{r summary5}
tbls_sst_SECM$SECMvar2021_May %>%
   knitr::kable(format = 'pandoc', caption = 'SECM survey sea surface temperature data were summarized by year (1997 to 2020), month (May), and depth (3m, 10m, 15m, and 20m). Only the Icy Strait and Upper Chatham transects (stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD) are included in this data set.', row.names = F, align = "c")
```

\pagebreak

```{r summary6}
tbls_sst_SECM$SECMvar2021_MJJ %>%
   knitr::kable(format = 'pandoc', caption = 'SECM survey sea surface temperature data were summarized by year (1997 to 2020), month (the months of May, June, and July), and depth (3m, 10m, 15m, and 20m). Only the Icy Strait and Upper Chatham transects (stations ISA, ISB, ISC, ISD, UCA, UCB, UCC, UCD) are included in this data set.', row.names = F, align = "c")
```

```{r fig1, fig.cap="The Icy Strait region is meant to replicate sampling that occurs from vessels in Icy Strait (Icy Strait and Upper Chatham transects), a migration pinch point for salmon in southeast Alaska. The Southeast Coastal Monitoring (SECM) project transects (Upper Chatham Strait and Icy Strait) are shown as red points for comparison to the satellite stations (i.e., data points; black circles)."}
knitr::include_graphics(here(results.directory, "Icy_Strait.png"))
```

```{r fig2, fig.cap="The Chatham Strait region encompasses waters of Chatham Strait from approximately the northern tip of Admiralty Island at Point Retreat (Point Retreat; 58.4115 degrees north latitude and -134.955 degrees west longitude) to the approximate latitude of 56.025 degrees north (roughly Cape Decision off Kuiu Island). The black circles are the satellite stations (i.e., data points)."}
knitr::include_graphics(here(results.directory, "Chatham.png"))
```

```{r fig3, fig.cap="The northern Southeast Alaska (NSEAK) region encompasses northern Southeast Alaska from 59.475 to 56.075 degrees north latitude and from -137.175 to -131.975 degrees west longitude. The black circles are the satellite stations (i.e., data points)."}
knitr::include_graphics(here(results.directory, "NSEAK.png"))
```

```{r fig4, fig.cap="The SST Jordan region is meant to replicate sampling of the Icy Strait transect (stations ISA, ISB, ISC, ISD) during the SECM survey. The black circles are the satellite stations (i.e., data points) and the SECM project stations (i.e., Icy Strait transect) are shown as red points for comparison."}
knitr::include_graphics(here(results.directory, "SST_Jordan.png"))
```

```{r fig5, fig.cap="A. The May temperature averaged over each region (Chatham Strait, Icy Strait, NSEAK, or SST Jordan) from 1997 through 2020. B. The May, June, and July temperature averaged over each region (Chatham Strait, Icy Strait, NSEAK, or SST Jordan) from 1997 through 2020."}
knitr::include_graphics(here(results.directory, "monthly_temp_regions.png"))
```

```{r fig6, fig.cap="A. Average temperature at 3m and in the upper 10m, 15m, or 20m during May at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects) from 1997 through 2020. B. Average temperature at 3m, and in the upper 10m, 15m, or 20m during May through July at 8 stations in Icy Strait (Icy Strait and Upper Chatham transects) from 1997 through 2020."}
knitr::include_graphics(here(results.directory, "monthly_SECM_temp_regions.png"))
```

```{r fig7, fig.cap="Mean temperature data (degrees Celsius) from 1997 through 2020 for the month of May and averaged over the months of May, June, and July for the Icy Strait region compared to the SECM survey region. The variable ISTI3 May is the May Icy Strait Temperature Index (average temperature at 3m in the Icy Strait and Upper Chatham stations). The variable ISTI3 MJJ is the average May, June, and July Icy Strait Temperature Index (average temperature at 3m in the Icy Strait and Upper Chatham stations). The variable Icy Strait SST May is the satellite sea surface temperature data averaged over the entire Icy Strait region for the month of May. The variable 'Icy Strait SST MJJ' is the satellite sea surface temperature averaged over the entire Icy Strait region for the months of May, June, and July."}
knitr::include_graphics(here(results.directory, "monthly_temp.png"))
```

# Acknowledgements
Jordan Watson (NOAA) helped with the code to process the satellite data into a usable format. The data was accessed through NOAA's Coral Reef Watch (https://coastwatch.pfeg.noaa.gov/erddap/griddap/NOAA_DHW_monthly.html. Emily Fergusson summarized the SECM survey data by year, month, and depth. All code and associated data are located here: https://github.com/commfish/southeast_pink_salmon_preseason in the 2022_forecast folder.

# References
Piston, A. W., J. Murphy, J. Moss, W. Strasburger, S. C. Heinl, E. Fergusson, S. Miller, A. Gray, and C. Waters. 2021. Operational Plan: Southeast coastal monitoring, 2021. Alaska Department of Fish and Game, Regional Operational Plan No. ROP.CF.1J.2021.02, Douglas.

NOAA Coral Reef Watch. 2021, updated daily. NOAA Coral Reef Watch Version 3.1 Monthly 5km SST and SST Anomaly, NOAA Global Coral Bleaching Monitoring Time Series Data, May 1997-July 2020. College Park, Maryland, USA: NOAA/NESDIS/STAR Coral Reef Watch program. Data set accessed 2021-04-09 at https://coastwatch.pfeg.noaa.gov/erddap/griddap/NOAA_DHW_monthly.html.

```{r sess_info, echo=FALSE}
sessionInfo()
```
